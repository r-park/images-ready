{"version":3,"sources":["jquery-imagesready.min.js"],"names":["root","factory","define","amd","exports","module","imagesReady","this","defer","deferred","promise","Promise","resolve","reject","ImagesReady","elements","options","document","querySelectorAll","toArray","images","findImageElements","jquery","$","Deferred","result","total","length","loaded","verified","verify","instance","slice","Array","prototype","validNodeTypes",1,9,11,"element","imageElements","i","nodeName","push","nodeType","n","l","proxy","imageSrc","image","Image","that","cleanup","removeEventListener","onload","onerror","addEventListener","update","src","clean","complete","naturalWidth","object","isArray","call","window","jQuery","fn"],"mappings":"CAAC,SAASA,EAAMC,GACQ,kBAAXC,SAAyBA,OAAOC,IACzCD,UAAWD,GACiB,gBAAZG,SAChBC,OAAOD,QAAUH,IAEjBD,EAAKM,YAAcL,KAErBM,KAAM,WACR,YAYA,SAASC,KACP,GAAIC,KAKJ,OAJAA,GAASC,QAAU,GAAIC,SAAQ,SAASC,EAASC,GAC/CJ,EAASG,QAAUA,EACnBH,EAASI,OAASA,IAEbJ,EAcT,QAASK,GAAYC,EAAUC,GACL,gBAAbD,KACTA,EAAWE,SAASC,iBAAiBH,IAGvCR,KAAKQ,SAAWR,KAAKY,QAAQJ,GAC7BR,KAAKa,OAASb,KAAKc,kBAAkBd,KAAKQ,UAEtCC,GAAWA,EAAQM,QACrBf,KAAKE,SAAW,GAAIc,GAAEC,SACtBjB,KAAKkB,OAASlB,KAAKE,SAASC,YAG5BH,KAAKE,SAAWD,IAChBD,KAAKkB,OAASlB,KAAKE,SAASC,SAG9BH,KAAKmB,MAAQnB,KAAKa,OAAOO,OACzBpB,KAAKqB,OAAS,EACdrB,KAAKsB,SAAW,EAEhBtB,KAAKuB,SAiJP,QAASxB,GAAYS,GACnB,GAAIgB,GAAW,GAAIjB,GAAYC,EAC/B,OAAOgB,GAASN,OArMlB,GAAIO,GAAQC,MAAMC,UAAUF,MAExBG,GACFC,GAAK,EACLC,GAAK,EACLC,IAAK,EAmMP,OAjJAxB,GAAYoB,WAMVb,kBAAoB,SAASN,GAM3B,IALA,GAEIwB,GACAC,EAHApB,KACAqB,EAAI1B,EAASY,OAIVc,KAGL,GAFAF,EAAUxB,EAAS0B,GAEM,QAArBF,EAAQG,SACVtB,EAAOuB,KAAKJ,OAET,IAAIA,EAAQK,UAAYT,EAAeI,EAAQK,UAAW,CAC7DJ,EAAgBD,EAAQrB,iBAAiB,MACzC,KAAK,GAAI2B,GAAI,EAAGC,EAAIN,EAAcb,OAAYmB,EAAJD,IAASA,EACjDzB,EAAOyB,GAAKL,EAAcK,GAKhC,MAAOzB,IAOT2B,MAAQ,SAASC,GACf,GAAIC,GAAQ,GAAIC,OACZC,EAAO5C,KAEP6C,EAAU,WACZH,EAAMI,oBAAoB,OAAQC,QAClCL,EAAMI,oBAAoB,OAAQE,SAClCN,EAAQ,KAGVA,GAAMO,iBAAiB,OAAQ,WAC7BL,EAAKvB,SACLuB,EAAKM,SACLL,MAGFH,EAAMO,iBAAiB,QAAS,WAC9BL,EAAKM,SACLL,MAGFH,EAAMS,IAAMV,GAOdS,OAAS,WACPlD,KAAKsB,WAEDtB,KAAKmB,QAAUnB,KAAKsB,WAClBtB,KAAKmB,QAAUnB,KAAKqB,OACtBrB,KAAKE,SAASG,QAAQL,KAAKQ,UAG3BR,KAAKE,SAASI,OAAO,QAGvBN,KAAKoD,UAQT7B,OAAS,WAMP,IALA,GAGImB,GAHA7B,EAASb,KAAKa,OACdqB,EAAI,GACJK,EAAI1B,EAAOO,SAGNc,EAAIK,GACXG,EAAQ7B,EAAOqB,GAEXQ,EAAMW,UAAYX,EAAMY,cAC1BtD,KAAKqB,SACLrB,KAAKkD,UAGLlD,KAAKwC,MAAME,EAAMS,MASvBC,MAAQ,WACNpD,KAAKQ,SAAW,KAChBR,KAAKa,OAAS,MAQhBD,QAAU,SAAS2C,GACjB,MAAI7B,OAAM8B,QAAQD,GAAgBA,EAEL,gBAAlBA,GAAOnC,OACTK,EAAMgC,KAAKF,IAGZA,KASRG,OAAOC,SACT3C,EAAE4C,GAAG7D,YAAc,WACjB,GAAIA,GAAc,GAAIQ,GAAYP,MAAOe,QAAQ,GACjD,OAAOhB,GAAYmB,SAahBnB","file":"jquery-imagesready.min.js","sourcesContent":["(function(root, factory) {\n  if (typeof define === 'function' && define.amd) {\n    define([], factory);\n  } else if (typeof exports === 'object') {\n    module.exports = factory();\n  } else {\n    root.imagesReady = factory();\n  }\n}(this, function() {\n'use strict';\n\n\nvar slice = Array.prototype.slice;\n\nvar validNodeTypes = {\n  1  : true,\n  9  : true,\n  11 : true\n};\n\n\nfunction defer() {\n  var deferred = {};\n  deferred.promise = new Promise(function(resolve, reject){\n    deferred.resolve = resolve;\n    deferred.reject = reject;\n  });\n  return deferred;\n}\n\n\n/**\n * @name ImagesReady\n * @constructor\n *\n * @param {Element|Element[]|jQuery|NodeList|string} elements\n *\n * @param {{}}      [options]\n * @param {boolean} [options.jquery]\n *\n */\nfunction ImagesReady(elements, options) {\n  if (typeof elements === 'string') {\n    elements = document.querySelectorAll(elements);\n  }\n\n  this.elements = this.toArray(elements);\n  this.images = this.findImageElements(this.elements);\n\n  if (options && options.jquery) {\n    this.deferred = new $.Deferred();\n    this.result = this.deferred.promise();\n  }\n  else {\n    this.deferred = defer();\n    this.result = this.deferred.promise;\n  }\n\n  this.total = this.images.length;\n  this.loaded = 0;\n  this.verified = 0;\n\n  this.verify();\n}\n\n\n\nImagesReady.prototype = {\n\n  /**\n   * @param {Element[]} elements\n   * @returns {HTMLImageElement[]}\n   */\n  findImageElements : function(elements) {\n    var images = [],\n        i = elements.length,\n        element,\n        imageElements;\n\n    while (i--) {\n      element = elements[i];\n\n      if (element.nodeName === 'IMG') {\n        images.push(element);\n      }\n      else if (element.nodeType && validNodeTypes[element.nodeType]) {\n        imageElements = element.querySelectorAll('img');\n        for (var n = 0, l = imageElements.length; n < l; ++n) {\n          images[n] = imageElements[n];\n        }\n      }\n    }\n\n    return images;\n  },\n\n\n  /**\n   * @param {string} imageSrc\n   */\n  proxy : function(imageSrc) {\n    var image = new Image(),\n        that = this;\n\n    var cleanup = function() {\n      image.removeEventListener('load', onload);\n      image.removeEventListener('load', onerror);\n      image = null;\n    };\n\n    image.addEventListener('load', function onload(){\n      that.loaded++;\n      that.update();\n      cleanup();\n    });\n\n    image.addEventListener('error', function onerror(){\n      that.update();\n      cleanup();\n    });\n\n    image.src = imageSrc;\n  },\n\n\n  /**\n   *\n   */\n  update : function() {\n    this.verified++;\n\n    if (this.total === this.verified) {\n      if (this.total === this.loaded) {\n        this.deferred.resolve(this.elements);\n      }\n      else {\n        this.deferred.reject('FAIL');\n      }\n\n      this.clean();\n    }\n  },\n\n\n  /**\n   *\n   */\n  verify : function() {\n    var images = this.images,\n        i = -1,\n        l = images.length,\n        image;\n\n    while (++i < l) {\n      image = images[i];\n\n      if (image.complete && image.naturalWidth) {\n        this.loaded++;\n        this.update();\n      }\n      else {\n        this.proxy(image.src);\n      }\n    }\n  },\n\n\n  /**\n   *\n   */\n  clean : function() {\n    this.elements = null;\n    this.images = null;\n  },\n\n\n  /**\n   * {Element|Element[]|NodeList} object\n   * @returns {Element[]}\n   */\n  toArray : function(object) {\n    if (Array.isArray(object)) return object;\n\n    if (typeof object.length === 'number') {\n      return slice.call(object);\n    }\n\n    return [object];\n  }\n\n};\n\n\n/*=========================================================\n  jQuery plugin\n=========================================================*/\nif (window.jQuery) {\n  $.fn.imagesReady = function() {\n    var imagesReady = new ImagesReady(this, {jquery: true}); // eslint-disable-line no-shadow\n    return imagesReady.result;\n  };\n}\n\n\n/*=========================================================\n  Default entry-point\n=========================================================*/\nfunction imagesReady(elements) { // eslint-disable-line no-unused-vars\n  var instance = new ImagesReady(elements);\n  return instance.result;\n}\n\nreturn imagesReady;\n}));\n"],"sourceRoot":"/source/"}